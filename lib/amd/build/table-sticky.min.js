define(["jquery","core/custom_interaction_events","core/log","core/pubsub"],function(a,b,c,d){var e={wrapper:"md-sticky-wrapper"},f={responsiveSusses:"stk:responsive-susses",responsiveStart:"stk:responsive-start",scrolling:"stk:scrolling",initSusses:"stk:init-susses",initStart:"stk:init-start"},g=function(b){this.config=b,this.tableSticky=a(b.table),this.isPositionStickySupport=this.positionStickySupport(),this.tableSticky.length||c.debug("Page is missing a sticky table region"),this.tableSticky.parent().hasClass(e.wrapper)||this.tableSticky.wrap('<div class="'+e.wrapper+' "></div>'),this.wrapperSticky=this.tableSticky.parent("."+e.wrapper),this.registerEventListeners(),d.publish(f.initStart,{stickytable:this});var g=this;this.wrapperSticky.scroll(function(){d.publish(f.scrolling,{stickytable:g})});var h;a(window).resize(function(){h&&clearTimeout(h),h=setTimeout(function(){d.publish(f.responsiveStart,{stickytable:g})},500)}),this.isPositionStickySupport||this.handelNotPositionStickySupport(),d.publish(f.initSusses,{stickytable:this})};return g.prototype.initStickyTable=function(){var b=this.config.stickies;a.each(b,function(b,c){a(c).addClass("md-sticky-"+b)})},g.prototype.handleResponsiveSticky=function(){d.publish(f.responsiveSusses,{stickytable:this})},g.prototype.registerEventListeners=function(){d.subscribe(f.responsiveStart,function(a){var b=a.stickytable;b.handleResponsiveSticky()}),d.subscribe(f.initStart,function(a){var b=a.stickytable;b.initStickyTable(),b.handleResponsiveSticky(),b.handleScrollSticky()}),d.subscribe(f.scrolling,function(a){var b=a.stickytable;b.handleScrollSticky()})},g.prototype.handleScrollSticky=function(){var b=this.config.stickies;a.each(b,function(b,c){var d=c.split(",");d.length<=1||d.forEach(function(c,d){if(!(d<1)){var e=a(c);switch(b){case"right":case"left":e.css(b,e.prev().outerWidth())}}})}),this.isPositionStickySupport||(navigator.userAgent.match(/Trident\/7\./)&&a(e.wrapper).on("mousewheel",function(b){b.preventDefault();var c=b.originalEvent.wheelDelta,d=a(this).scrollTop();a(this).scrollTop(d-c)}),this.handelNotPositionStickySupport())},g.prototype.handelNotPositionStickySupport=function(){var b=this.wrapperSticky.scrollTop(),c=a(".md-sticky-top").prev();c.length>0&&b<c.outerHeight()?c.show():c.hide(),this.tableSticky.find("tr.md-sticky-top th").css("top",b),this.tableSticky.find("tr.md-sticky-top td").css("top",b);var d=this.tableSticky.prop("clientHeight")-this.wrapperSticky.prop("clientHeight");this.tableSticky.find("tr.md-sticky-bottom th").css("bottom",d-this.wrapperSticky.scrollTop()),this.tableSticky.find("tr.md-sticky-bottom td").css("bottom",d-this.wrapperSticky.scrollTop()),this.tableSticky.find("th.md-sticky-left").css("left",this.wrapperSticky.scrollLeft()),this.tableSticky.find("td.md-sticky-left").css("left",this.wrapperSticky.scrollLeft()),d=this.wrapperSticky.find("table").prop("clientWidth")-this.wrapperSticky.prop("clientWidth"),this.tableSticky.find("th.md-sticky-right").css("right",d-this.wrapperSticky.scrollLeft()),this.tableSticky.find("td.md-sticky-right").css("right",d-this.wrapperSticky.scrollLeft())},g.prototype.positionStickySupport=function(){var a=document.createElement("a"),b=a.style;return b.cssText="position:sticky;position:-webkit-sticky;position:-ms-sticky;",b.position.indexOf("sticky")!==-1},{init:function(a){return new g(a)},EVENTS:f}});